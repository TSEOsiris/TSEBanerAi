# –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## üìã –û–±–∑–æ—Ä

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö `bannerlord_lore.db` —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –î–ª—è –∫–∞–∂–¥–æ–π —Å—É—â–Ω–æ—Å—Ç–∏ (–∫–ª–∞–Ω—ã, –≥–µ—Ä–æ–∏, –ø–æ—Å–µ–ª–µ–Ω–∏—è, –∫–æ—Ä–æ–ª–µ–≤—Å—Ç–≤–∞) —Ö—Ä–∞–Ω—è—Ç—Å—è –∫–∞–∫ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ, —Ç–∞–∫ –∏ —Ä—É—Å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∏ –æ–ø–∏—Å–∞–Ω–∏—è.

## üåê –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —è–∑—ã–∫–∏

- **–ê–Ω–≥–ª–∏–π—Å–∫–∏–π (EN)** - –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫, –≤—Å–µ–≥–¥–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- **–†—É—Å—Å–∫–∏–π (RU)** - –¥–æ–±–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ —ç–∫—Å–ø–æ—Ä—Ç –∏–≥—Ä—ã –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- **–¢—É—Ä–µ—Ü–∫–∏–π (TR)** - –¥–æ–±–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ —ç–∫—Å–ø–æ—Ä—Ç –∏–≥—Ä—ã –Ω–∞ —Ç—É—Ä–µ—Ü–∫–æ–º —è–∑—ã–∫–µ

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü—ã —Å –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π

#### `campaign_clans`
- `name` - –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º
- `name_ru` - –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º
- `name_tr` - –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–∞ —Ç—É—Ä–µ—Ü–∫–æ–º
- `informal_name` - –Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ (EN)
- `informal_name_ru` - –Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ (RU)
- `informal_name_tr` - –Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ (TR)
- `leader_name` - –∏–º—è –ª–∏–¥–µ—Ä–∞ (EN)
- `leader_name_ru` - –∏–º—è –ª–∏–¥–µ—Ä–∞ (RU)
- `leader_name_tr` - –∏–º—è –ª–∏–¥–µ—Ä–∞ (TR)
- `description` - –æ–ø–∏—Å–∞–Ω–∏–µ (EN)
- `description_ru` - –æ–ø–∏—Å–∞–Ω–∏–µ (RU)
- `description_tr` - –æ–ø–∏—Å–∞–Ω–∏–µ (TR)

#### `campaign_heroes`
- `name` - –∏–º—è (EN)
- `name_ru` - –∏–º—è (RU)
- `name_tr` - –∏–º—è (TR)

#### `campaign_settlements`
- `name` - –Ω–∞–∑–≤–∞–Ω–∏–µ (EN)
- `name_ru` - –Ω–∞–∑–≤–∞–Ω–∏–µ (RU)
- `name_tr` - –Ω–∞–∑–≤–∞–Ω–∏–µ (TR)
- `owner_name` - –∏–º—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ (EN)
- `owner_name_ru` - –∏–º—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ (RU)
- `owner_name_tr` - –∏–º—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ (TR)

#### `campaign_kingdoms`
- `name` - –Ω–∞–∑–≤–∞–Ω–∏–µ (EN)
- `name_ru` - –Ω–∞–∑–≤–∞–Ω–∏–µ (RU)
- `name_tr` - –Ω–∞–∑–≤–∞–Ω–∏–µ (TR)
- `ruler_name` - –∏–º—è –ø—Ä–∞–≤–∏—Ç–µ–ª—è (EN)
- `ruler_name_ru` - –∏–º—è –ø—Ä–∞–≤–∏—Ç–µ–ª—è (RU)
- `ruler_name_tr` - –∏–º—è –ø—Ä–∞–≤–∏—Ç–µ–ª—è (TR)

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏

#### –†—É—Å—Å–∫–∏–π —è–∑—ã–∫
```bash
# –ü–æ—Å–ª–µ —ç–∫—Å–ø–æ—Ä—Ç–∞ –∏–≥—Ä—ã –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
py scripts/add_russian_localization.py
```

#### –¢—É—Ä–µ—Ü–∫–∏–π —è–∑—ã–∫
```bash
# –ü–æ—Å–ª–µ —ç–∫—Å–ø–æ—Ä—Ç–∞ –∏–≥—Ä—ã –Ω–∞ —Ç—É—Ä–µ—Ü–∫–æ–º —è–∑—ã–∫–µ
py scripts/add_turkish_localization.py
```

–°–∫—Ä–∏–ø—Ç—ã:
1. –î–æ–±–∞–≤–ª—è—é—Ç –∫–æ–ª–æ–Ω–∫–∏ `*_ru` –∏–ª–∏ `*_tr` –≤ —Ç–∞–±–ª–∏—Ü—ã (–µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç)
2. –û–ø—Ä–µ–¥–µ–ª—è—é—Ç —è–∑—ã–∫ —Ç–µ–∫—Å—Ç–∞ (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞ –¥–ª—è RU, —Ç—É—Ä–µ—Ü–∫–∏–µ —Å–∏–º–≤–æ–ª—ã –¥–ª—è TR)
3. –û–±–Ω–æ–≤–ª—è—é—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã–º–∏ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º —è–∑—ã–∫–µ

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

#### –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ –≤—Å–µ—Ö —è–∑—ã–∫–∞—Ö

```sql
SELECT 
    id,
    name AS name_en,
    name_ru,
    name_tr,
    settlement_type
FROM campaign_settlements
WHERE id = 'town_EN2';
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:
```
id: town_EN2
name_en: Diathma
name_ru: –î–∏–∞—Ç–º–∞
name_tr: (–º–æ–∂–µ—Ç –±—ã—Ç—å NULL)
```

#### –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–∞—Ö

```sql
-- –ü–æ–∏—Å–∫ –ø–æ —Ä—É—Å—Å–∫–æ–º—É
SELECT id, name_ru, name AS name_en, name_tr
FROM campaign_settlements
WHERE name_ru LIKE '%–î–∏–∞—Ç–º–∞%';

-- –ü–æ–∏—Å–∫ –ø–æ —Ç—É—Ä–µ—Ü–∫–æ–º—É
SELECT id, name_tr, name AS name_en, name_ru
FROM campaign_settlements
WHERE name_tr LIKE '%Diathma%';
```

#### –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å EN, RU –∏ TR)

```python
import re

def is_cyrillic(text):
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∏—Ä–∏–ª–ª–∏—Ü—ã"""
    return bool(re.search(r'[–ê-–Ø–∞-—è–Å—ë]', text))

def is_turkish(text):
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—É—Ä–µ—Ü–∫–æ–≥–æ —è–∑—ã–∫–∞"""
    return bool(re.search(r'[√ß√áƒüƒûƒ±ƒ∞√∂√ñ≈ü≈û√º√ú]', text))

def search_settlement(query):
    """–ü–æ–∏—Å–∫ –ø–æ—Å–µ–ª–µ–Ω–∏—è –Ω–∞ –ª—é–±–æ–º —è–∑—ã–∫–µ"""
    is_ru = is_cyrillic(query)
    is_tr = is_turkish(query)
    
    if is_ru:
        cursor.execute('''
            SELECT id, name_ru, name AS name_en, name_tr
            FROM campaign_settlements
            WHERE name_ru LIKE ? OR name LIKE ? OR name_tr LIKE ?
        ''', (f'%{query}%', f'%{query}%', f'%{query}%'))
    elif is_tr:
        cursor.execute('''
            SELECT id, name_tr, name AS name_en, name_ru
            FROM campaign_settlements
            WHERE name_tr LIKE ? OR name LIKE ? OR name_ru LIKE ?
        ''', (f'%{query}%', f'%{query}%', f'%{query}%'))
    else:
        cursor.execute('''
            SELECT id, name AS name_en, name_ru, name_tr
            FROM campaign_settlements
            WHERE name LIKE ? OR name_ru LIKE ? OR name_tr LIKE ?
        ''', (f'%{query}%', f'%{query}%', f'%{query}%'))
    
    return cursor.fetchall()
```

#### –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ —è–∑—ã–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```python
def get_settlement_name(settlement_id, lang='en'):
    """–ü–æ–ª—É—á–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ—Å–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω—É–∂–Ω–æ–º —è–∑—ã–∫–µ"""
    cursor.execute('''
        SELECT 
            CASE 
                WHEN ? = 'ru' THEN COALESCE(name_ru, name_tr, name)
                WHEN ? = 'tr' THEN COALESCE(name_tr, name_ru, name)
                ELSE name
            END AS name
        FROM campaign_settlements
        WHERE id = ?
    ''', (lang, lang, settlement_id))
    
    row = cursor.fetchone()
    return row['name'] if row else None
```

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

–ü–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏:

### –†—É—Å—Å–∫–∏–π —è–∑—ã–∫
- **–ö–ª–∞–Ω—ã**: 105/106 (99%) –∏–º–µ—é—Ç —Ä—É—Å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è
- **–ì–µ—Ä–æ–∏**: 1927/1928 (99%) –∏–º–µ—é—Ç —Ä—É—Å—Å–∫–∏–µ –∏–º–µ–Ω–∞
- **–ü–æ—Å–µ–ª–µ–Ω–∏—è**: 540/540 (100%) –∏–º–µ—é—Ç —Ä—É—Å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è
- **–ö–æ—Ä–æ–ª–µ–≤—Å—Ç–≤–∞**: 9/9 (100%) –∏–º–µ—é—Ç —Ä—É—Å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è

### –¢—É—Ä–µ—Ü–∫–∏–π —è–∑—ã–∫
- **–ö–ª–∞–Ω—ã**: 33/106 (31%) –∏–º–µ—é—Ç —Ç—É—Ä–µ—Ü–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è
- **–ì–µ—Ä–æ–∏**: 231/1928 (11%) –∏–º–µ—é—Ç —Ç—É—Ä–µ—Ü–∫–∏–µ –∏–º–µ–Ω–∞
- **–ü–æ—Å–µ–ª–µ–Ω–∏—è**: 101/540 (18%) –∏–º–µ—é—Ç —Ç—É—Ä–µ—Ü–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è
- **–ö–æ—Ä–æ–ª–µ–≤—Å—Ç–≤–∞**: 3/9 (33%) –∏–º–µ—é—Ç —Ç—É—Ä–µ—Ü–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è

*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –¢—É—Ä–µ—Ü–∫–∞—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø–æ–ª–Ω–æ–π, –µ—Å–ª–∏ —ç–∫—Å–ø–æ—Ä—Ç –±—ã–ª –≤—ã–ø–æ–ª–Ω–µ–Ω —á–∞—Å—Ç–∏—á–Ω–æ –∏–ª–∏ JSON —Ñ–∞–π–ª—ã —Å–æ–¥–µ—Ä–∂–∞—Ç —Å–º–µ—à–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.*

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ RAG

–î–ª—è RAG —Å–∏—Å—Ç–µ–º—ã –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å FTS5 –∏–Ω–¥–µ–∫—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∏—Å–∫–∞—Ç—å –ø–æ –≤—Å–µ–º —è–∑—ã–∫–∞–º:

```sql
-- –°–æ–∑–¥–∞—Ç—å FTS5 —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
CREATE VIRTUAL TABLE settlements_fts_multilang USING fts5(
    id,
    name,      -- EN
    name_ru,   -- RU
    name_tr,   -- TR
    content='campaign_settlements'
);

-- –ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ª—é–±–æ–º —è–∑—ã–∫–µ
SELECT * FROM settlements_fts_multilang 
WHERE settlements_fts_multilang MATCH '–î–∏–∞—Ç–º–∞ OR Diathma OR Diathma';
```

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

1. **–≠–∫—Å–ø–æ—Ä—Ç –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º** ‚Üí `import_campaign_data.py`
   - –°–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å–∏ —Å –∞–Ω–≥–ª–∏–π—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏

2. **–≠–∫—Å–ø–æ—Ä—Ç –Ω–∞ —Ä—É—Å—Å–∫–æ–º** ‚Üí `add_russian_localization.py`
   - –î–æ–±–∞–≤–ª—è–µ—Ç —Ä—É—Å—Å–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏
   - –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏ —Ä—É—Å—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏

3. **–≠–∫—Å–ø–æ—Ä—Ç –Ω–∞ —Ç—É—Ä–µ—Ü–∫–æ–º** ‚Üí `add_turkish_localization.py`
   - –î–æ–±–∞–≤–ª—è–µ—Ç —Ç—É—Ä–µ—Ü–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏
   - –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏ —Ç—É—Ä–µ—Ü–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏

4. **–ü–æ–≤—Ç–æ—Ä–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç** ‚Üí –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –≤ –ª—é–±–æ–º –ø–æ—Ä—è–¥–∫–µ
   - `INSERT OR REPLACE` –æ–±–Ω–æ–≤–∏—Ç –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
   - `UPDATE` –æ–±–Ω–æ–≤–∏—Ç —Ä—É—Å—Å–∫–∏–µ/—Ç—É—Ä–µ—Ü–∫–∏–µ –¥–∞–Ω–Ω—ã–µ

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–í—Å–µ–≥–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –≤—Å–µ —è–∑—ã–∫–∏** - –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –æ–¥–Ω–æ–≥–æ —è–∑—ã–∫–∞ –¥–∞–Ω–Ω—ã–º–∏ –¥—Ä—É–≥–æ–≥–æ
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ COALESCE** –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö –¥–ª—è fallback: `COALESCE(name_ru, name_tr, name)`
3. **–û–ø—Ä–µ–¥–µ–ª—è–π—Ç–µ —è–∑—ã–∫ –∑–∞–ø—Ä–æ—Å–∞** –ø–µ—Ä–µ–¥ –ø–æ–∏—Å–∫–æ–º –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞ = RU, —Ç—É—Ä–µ—Ü–∫–∏–µ —Å–∏–º–≤–æ–ª—ã = TR)
4. **–°–æ–∑–¥–∞–≤–∞–π—Ç–µ FTS5 –∏–Ω–¥–µ–∫—Å—ã** –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ –≤—Å–µ–º —è–∑—ã–∫–∞–º
5. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö** –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º: `WHERE name_ru IS NOT NULL`

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–°–º. `scripts/query_multilang_data.py` –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (EN, RU, TR).

## üîç –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞

### –†—É—Å—Å–∫–∏–π —è–∑—ã–∫
–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ –Ω–∞–ª–∏—á–∏—é –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤: `[–ê-–Ø–∞-—è–Å—ë]`

### –¢—É—Ä–µ—Ü–∫–∏–π —è–∑—ã–∫
–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ:
- –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–º —Ç—É—Ä–µ—Ü–∫–∏–º —Å–∏–º–≤–æ–ª–∞–º: `[√ß√áƒüƒûƒ±ƒ∞√∂√ñ≈ü≈û√º√ú]`
- –•–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–º —Ç—É—Ä–µ—Ü–∫–∏–º —Å–ª–æ–≤–∞–º: `ve`, `bir`, `bu`, `ile`, `i√ßin`, `gibi`, –∏ —Ç.–¥.

